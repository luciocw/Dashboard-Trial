<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Dynasty Pro - Premium View</title>
    <script src="https://unpkg.com/dexie@latest/dist/dexie.js"></script>
    <style>
        body { font-family: sans-serif; background: #1a1d21; color: #e8eaed; padding: 20px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; }
        .card { background: #23272e; padding: 15px; border-radius: 10px; border: 1px solid #3c4149; }
        .accent { color: #5c9eff; font-weight: bold; }
        .premium-tag { background: rgba(161, 133, 247, 0.2); color: #a185f7; padding: 4px 8px; border-radius: 4px; font-size: 0.7rem; }
    </style>
</head>
<body>
    <h1 id="welcome">Aguardando dados do Dashboard Principal...</h1>
    <div id="app" class="grid"></div>

    <script>
        const db = new Dexie('FantasyAuditorDB');
        db.version(1).stores({ stats: 'id' });

        async function listenToBrain() {
            const data = await db.stats.get('current_leagues');
            
            if (data && data.payload) {
                document.getElementById('welcome').innerHTML = `Analítico Pro: <span class="accent">${data.user}</span>`;
                renderPremiumView(data.payload);
            }
        }

        function renderPremiumView(leagues) {
            const container = document.getElementById('app');
            container.innerHTML = leagues.map(l => `
                <div class="card">
                    <div class="premium-tag">PRO AUDIT ACTIVE</div>
                    <h3 style="margin: 10px 0;">${l.name}</h3>
                    <p style="font-size: 0.8rem; color: #9aa0a6;">${l.total_rosters} Times • Week ${l.settings.last_scored_leg || '1'}</p>
                    <div style="margin-top: 10px; color: #34a853; font-size: 0.9rem;">
                        ✓ Dados sincronizados via Database
                    </div>
                </div>
            `).join('');
        }

        // Tenta ler os dados a cada 3 segundos
        setInterval(listenToBrain, 3000);
        listenToBrain();
    </script>
</body>
</html>
